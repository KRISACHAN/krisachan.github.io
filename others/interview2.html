<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>『中高级前端面试』之终极知识点 | 鱼头的Web海洋</title>
    <meta name="description" content="让你的Web学习如同玩耍在海洋一样快乐" />
    <link rel="icon" href="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/base/blogfavicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.a57752fc.css" as="style"><link rel="preload" href="/assets/js/app.15224212.js" as="script"><link rel="preload" href="/assets/js/43.c9233ecb.js" as="script"><link rel="prefetch" href="/assets/js/2.ee28eecc.js"><link rel="prefetch" href="/assets/js/3.4f75b704.js"><link rel="prefetch" href="/assets/js/4.bf787673.js"><link rel="prefetch" href="/assets/js/5.478f5ac2.js"><link rel="prefetch" href="/assets/js/6.4c097f64.js"><link rel="prefetch" href="/assets/js/7.58a8b71c.js"><link rel="prefetch" href="/assets/js/8.3f46aa1d.js"><link rel="prefetch" href="/assets/js/9.b22bdfb2.js"><link rel="prefetch" href="/assets/js/10.66b6a51e.js"><link rel="prefetch" href="/assets/js/11.7e6ee11d.js"><link rel="prefetch" href="/assets/js/12.00a57e71.js"><link rel="prefetch" href="/assets/js/13.a3ebb5cb.js"><link rel="prefetch" href="/assets/js/14.24257f57.js"><link rel="prefetch" href="/assets/js/15.e9fbe090.js"><link rel="prefetch" href="/assets/js/16.3274933f.js"><link rel="prefetch" href="/assets/js/17.c44a15a9.js"><link rel="prefetch" href="/assets/js/18.9d746e2b.js"><link rel="prefetch" href="/assets/js/19.baae15bc.js"><link rel="prefetch" href="/assets/js/20.9aaca5ee.js"><link rel="prefetch" href="/assets/js/21.aec3f975.js"><link rel="prefetch" href="/assets/js/22.21ec2527.js"><link rel="prefetch" href="/assets/js/23.215265ec.js"><link rel="prefetch" href="/assets/js/24.32608e97.js"><link rel="prefetch" href="/assets/js/25.7e58b716.js"><link rel="prefetch" href="/assets/js/26.0ce95665.js"><link rel="prefetch" href="/assets/js/27.2bec40fe.js"><link rel="prefetch" href="/assets/js/28.37c3e242.js"><link rel="prefetch" href="/assets/js/29.25240822.js"><link rel="prefetch" href="/assets/js/30.b2239b28.js"><link rel="prefetch" href="/assets/js/31.3232657a.js"><link rel="prefetch" href="/assets/js/32.2c64e26e.js"><link rel="prefetch" href="/assets/js/33.2f410f00.js"><link rel="prefetch" href="/assets/js/34.7bbb4327.js"><link rel="prefetch" href="/assets/js/35.31641123.js"><link rel="prefetch" href="/assets/js/36.ee53c3f2.js"><link rel="prefetch" href="/assets/js/37.1cc74cfa.js"><link rel="prefetch" href="/assets/js/38.01be8ced.js"><link rel="prefetch" href="/assets/js/39.527228ee.js"><link rel="prefetch" href="/assets/js/40.039ceeb7.js"><link rel="prefetch" href="/assets/js/41.f8a58390.js"><link rel="prefetch" href="/assets/js/42.c8d82b92.js"><link rel="prefetch" href="/assets/js/44.12be25a3.js"><link rel="prefetch" href="/assets/js/45.4806da16.js"><link rel="prefetch" href="/assets/js/46.d7699a9c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a57752fc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">鱼头的Web海洋</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!----> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>『中高级前端面试』之终极知识点</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/others/interview2.html#chrome-浏览器进程" class="sidebar-link">Chrome 浏览器进程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#浏览器主进程" class="sidebar-link">浏览器主进程</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#gpu-进程" class="sidebar-link">GPU 进程</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#网络进程" class="sidebar-link">网络进程</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#插件进程" class="sidebar-link">插件进程</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#渲染进程" class="sidebar-link">渲染进程</a></li></ul></li><li><a href="/others/interview2.html#网络传输流程" class="sidebar-link">网络传输流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#生成-http-请求消息" class="sidebar-link">生成 HTTP 请求消息</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#向-dns-服务器查询-web-服务器的-ip-地址" class="sidebar-link">向 DNS 服务器查询 Web 服务器的 IP 地址</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#全世界-dns-服务器的大接力" class="sidebar-link">全世界 DNS 服务器的大接力</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#委托协议栈发送消息" class="sidebar-link">委托协议栈发送消息</a></li></ul></li><li><a href="/others/interview2.html#跨域" class="sidebar-link">跨域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#同源策略" class="sidebar-link">同源策略</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#主要的跨域处理" class="sidebar-link">主要的跨域处理</a></li></ul></li><li><a href="/others/interview2.html#网络协议" class="sidebar-link">网络协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#tcp" class="sidebar-link">TCP</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#udp" class="sidebar-link">UDP</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#http" class="sidebar-link">HTTP</a></li></ul></li><li><a href="/others/interview2.html#页面渲染流程" class="sidebar-link">页面渲染流程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/others/interview2.html#页面更新机制" class="sidebar-link">页面更新机制</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/others/interview2.html#js-执行机制" class="sidebar-link">JS 执行机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#代码提升（为了编译）" class="sidebar-link">代码提升（为了编译）</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#编译代码" class="sidebar-link">编译代码</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#执行代码" class="sidebar-link">执行代码</a></li></ul></li><li><a href="/others/interview2.html#类型" class="sidebar-link">类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#基本类型" class="sidebar-link">基本类型</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#复杂类型" class="sidebar-link">复杂类型</a></li></ul></li><li><a href="/others/interview2.html#隐式转换规则" class="sidebar-link">隐式转换规则</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#基本情况" class="sidebar-link">基本情况</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#转换为原始类型" class="sidebar-link">转换为原始类型</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#转换为布尔值" class="sidebar-link">转换为布尔值</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#转换为数字" class="sidebar-link">转换为数字</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#转换为字符串" class="sidebar-link">转换为字符串</a></li></ul></li><li><a href="/others/interview2.html#this" class="sidebar-link">this</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/others/interview2.html#闭包" class="sidebar-link">闭包</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/others/interview2.html#作用域" class="sidebar-link">作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#全局作用域" class="sidebar-link">全局作用域</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#函数作用域" class="sidebar-link">函数作用域</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#局部作用域" class="sidebar-link">局部作用域</a></li></ul></li><li><a href="/others/interview2.html#作用域链" class="sidebar-link">作用域链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#词法作用域" class="sidebar-link">词法作用域</a></li></ul></li><li><a href="/others/interview2.html#原型-原型链" class="sidebar-link">原型&amp;原型链</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/others/interview2.html#v8-工作原理" class="sidebar-link">V8 工作原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#数据存储" class="sidebar-link">数据存储</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#垃圾回收" class="sidebar-link">垃圾回收</a></li></ul></li><li><a href="/others/interview2.html#事件循环" class="sidebar-link">事件循环</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#微任务（microtask）" class="sidebar-link">微任务（microtask）</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#宏任务（macrotask）" class="sidebar-link">宏任务（macrotask）</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#执行顺序" class="sidebar-link">执行顺序</a></li></ul></li><li><a href="/others/interview2.html#浏览器安全" class="sidebar-link">浏览器安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#攻击方式" class="sidebar-link">攻击方式</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#防御措施" class="sidebar-link">防御措施</a></li></ul></li><li><a href="/others/interview2.html#浏览器性能" class="sidebar-link">浏览器性能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#dns-预解析" class="sidebar-link">DNS 预解析</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#强缓存" class="sidebar-link">强缓存</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#协商缓存" class="sidebar-link">协商缓存</a></li></ul></li><li><a href="/others/interview2.html#nodejs" class="sidebar-link">NodeJs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#单线程" class="sidebar-link">单线程</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#非阻塞-i-o" class="sidebar-link">非阻塞 I/O</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#事件循环-2" class="sidebar-link">事件循环</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#libuv" class="sidebar-link">Libuv</a></li></ul></li><li><a href="/others/interview2.html#手写代码" class="sidebar-link">手写代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#new-操作符" class="sidebar-link">new 操作符</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#深拷贝" class="sidebar-link">深拷贝</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#手写-bind" class="sidebar-link">手写 bind</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#手写函数柯里化" class="sidebar-link">手写函数柯里化</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#手写-promise" class="sidebar-link">手写 Promise</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#手写防抖函数" class="sidebar-link">手写防抖函数</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#手写节流函数" class="sidebar-link">手写节流函数</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#手写-instanceof" class="sidebar-link">手写 instanceOf</a></li></ul></li><li><a href="/others/interview2.html#其它知识" class="sidebar-link">其它知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/interview2.html#typeof-vs-instanceof" class="sidebar-link">typeof vs instanceof</a></li><li class="sidebar-sub-header"><a href="/others/interview2.html#递归" class="sidebar-link">递归</a></li></ul></li><li><a href="/others/interview2.html#参考资料" class="sidebar-link">参考资料</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/others/interview2.html#后记" class="sidebar-link">后记</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="『中高级前端面试』之终极知识点"><a href="#『中高级前端面试』之终极知识点" aria-hidden="true" class="header-anchor">#</a> 『中高级前端面试』之终极知识点</h1> <blockquote><ul><li>作者：陈大鱼头</li> <li>github： <a href="https://github.com/KRISACHAN" target="_blank" rel="noopener noreferrer">KRISACHAN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></blockquote> <h2 id="chrome-浏览器进程"><a href="#chrome-浏览器进程" aria-hidden="true" class="header-anchor">#</a> Chrome 浏览器进程</h2> <blockquote><p>在资源不足的设备上，将服务合并到浏览器进程中</p></blockquote> <h3 id="浏览器主进程"><a href="#浏览器主进程" aria-hidden="true" class="header-anchor">#</a> 浏览器主进程</h3> <ul><li><p>负责浏览器界面显示</p></li> <li><p>各个页面的管理，创建以及销毁</p></li> <li><p>将渲染进程的结果绘制到用户界面上</p></li> <li><p>网络资源管理</p></li></ul> <h3 id="gpu-进程"><a href="#gpu-进程" aria-hidden="true" class="header-anchor">#</a> GPU 进程</h3> <ul><li>用于 3D 渲染绘制</li></ul> <h3 id="网络进程"><a href="#网络进程" aria-hidden="true" class="header-anchor">#</a> 网络进程</h3> <ul><li>发起网络请求</li></ul> <h3 id="插件进程"><a href="#插件进程" aria-hidden="true" class="header-anchor">#</a> 插件进程</h3> <ul><li>第三方插件处理，运行在沙箱中</li></ul> <h3 id="渲染进程"><a href="#渲染进程" aria-hidden="true" class="header-anchor">#</a> 渲染进程</h3> <ul><li><p>页面渲染</p></li> <li><p>脚本执行</p></li> <li><p>事件处理</p></li></ul> <h2 id="网络传输流程"><a href="#网络传输流程" aria-hidden="true" class="header-anchor">#</a> 网络传输流程</h2> <h3 id="生成-http-请求消息"><a href="#生成-http-请求消息" aria-hidden="true" class="header-anchor">#</a> 生成 HTTP 请求消息</h3> <ol><li><p>输入网址</p></li> <li><p>浏览浏览器解析 URL</p></li> <li><p>生成 HTTP 请求信息</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/http-request.png" alt></p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/http-response.png" alt></p></li> <li><p>收到响应</p> <table><thead><tr><th>状态码</th> <th>含义</th></tr></thead> <tbody><tr><td>1xx</td> <td>告知请求的处理进度和情况</td></tr> <tr><td>2xx</td> <td>成功</td></tr> <tr><td>3xx</td> <td>表示需要进一步操作</td></tr> <tr><td>4xx</td> <td>客户端错误</td></tr> <tr><td>5xx</td> <td>服务端错误</td></tr></tbody></table></li></ol> <h3 id="向-dns-服务器查询-web-服务器的-ip-地址"><a href="#向-dns-服务器查询-web-服务器的-ip-地址" aria-hidden="true" class="header-anchor">#</a> 向 DNS 服务器查询 Web 服务器的 IP 地址</h3> <ol><li><p>Socket 库提供查询 IP 地址的功能</p></li> <li><p>通过解析器向 DNS 服务器发出查询</p></li></ol> <h3 id="全世界-dns-服务器的大接力"><a href="#全世界-dns-服务器的大接力" aria-hidden="true" class="header-anchor">#</a> 全世界 DNS 服务器的大接力</h3> <ol><li><p>寻找相应的 DNS 服务器并获取 IP 地址</p></li> <li><p>通过缓存加快 DNS 服务器的响应</p></li></ol> <h3 id="委托协议栈发送消息"><a href="#委托协议栈发送消息" aria-hidden="true" class="header-anchor">#</a> 委托协议栈发送消息</h3> <blockquote><p>协议栈通过 TCP 协议收发数据的操作。</p></blockquote> <ol><li>创建套接字</li></ol> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/create.png" alt></p> <ul><li>浏览器，邮件等一般的应用程序收发数据时用 TCP</li> <li>DNS 查询等收发较短的控制数据时用 UDP</li></ul> <ol start="2"><li>连接服务器</li></ol> <blockquote><p>浏览器调用 Socket.connect</p></blockquote> <ul><li>在 TCP 模块处创建表示连接控制信息的头部</li> <li>通过 TCP 头部中的发送方和接收方端口号找到要连接的套接字</li></ul> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/connect.png" alt></p> <ol start="3"><li>收发数据</li></ol> <blockquote><p>浏览器调用 Socket.write</p></blockquote> <ul><li><p>将 HTTP 请求消息交给协议栈</p></li> <li><p>对较大的数据进行拆分，拆分的每一块数据加上 TCP 头，由 IP 模块来发送</p></li> <li><p>使用 ACK 号确认网络包已收到</p></li> <li><p>根据网络包平均往返时间调整 ACK 号等待时间</p></li> <li><p>使用窗口有效管理 ACK 号</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/ack_window.png" alt></p></li> <li><p>ACK 与窗口的合并</p></li> <li><p>接收 HTTP 响应消息</p></li></ul> <ol start="4"><li>断开管道并删除套接字</li></ol> <blockquote><p>浏览器调用 Socket.close</p></blockquote> <ul><li><p>数据发送完毕后断开连接</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/disconnect.png" alt></p></li> <li><p>删除套接字</p> <ol><li>客户端发送 FIN</li> <li>服务端返回 ACK 号</li> <li>服务端发送 FIN</li> <li>客户端返回 ACK 号</li></ol></li></ul> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/Socket.png" alt></p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/whole.png" alt></p> <h2 id="跨域"><a href="#跨域" aria-hidden="true" class="header-anchor">#</a> 跨域</h2> <h3 id="同源策略"><a href="#同源策略" aria-hidden="true" class="header-anchor">#</a> 同源策略</h3> <blockquote><p>同源策略是一个重要的安全策略，它用于限制一个origin的文档或者它加载的脚本如何能与另一个源的资源进行交互。它能帮助阻隔恶意文档，减少可能被攻击的媒介。</p></blockquote> <p>如果两个 URL 的 <strong>protocol</strong> 、 <strong>port</strong>  (如果有指定的话)和 <strong>host</strong> 都相同的话，则这两个 URL 是同源。</p> <p>例如：</p> <table><thead><tr><th style="text-align:left">URL</th> <th style="text-align:left">结果</th> <th style="text-align:left">原因</th></tr></thead> <tbody><tr><td style="text-align:left"><code>http://store.company.com/dir2/other.html</code></td> <td style="text-align:left">同源</td> <td style="text-align:left">只有路径不同</td></tr> <tr><td style="text-align:left"><code>http://store.company.com/dir/inner/another.html</code></td> <td style="text-align:left">同源</td> <td style="text-align:left">只有路径不同</td></tr> <tr><td style="text-align:left"><code>https://store.company.com/secure.html</code></td> <td style="text-align:left">失败</td> <td style="text-align:left">协议不同</td></tr> <tr><td style="text-align:left"><code>http://store.company.com:81/dir/etc.html</code></td> <td style="text-align:left">失败</td> <td style="text-align:left">端口不同 ( <code>http://</code> 默认端口是80)</td></tr> <tr><td style="text-align:left"><code>http://news.company.com/dir/other.html</code></td> <td style="text-align:left">失败</td> <td style="text-align:left">主机不同</td></tr></tbody></table> <h3 id="主要的跨域处理"><a href="#主要的跨域处理" aria-hidden="true" class="header-anchor">#</a> 主要的跨域处理</h3> <p><strong>JSONP</strong></p> <p>JSONP的原理是：静态资源请求不受同源策略影响。实现如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span>
script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'https://www.domain.com/a?data=1&amp;callback=cb'</span>
<span class="token keyword">const</span> <span class="token function-variable function">cb</span> <span class="token operator">=</span> res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>CORS</strong></p> <p>CORS：跨域资源共享(CORS) 是一种机制，它使用额外的 HTTP 头来告诉浏览器  让运行在一个 origin (domain) 上的Web应用被准许访问来自不同源服务器上的指定的资源。</p> <p>在各种服务端代码实现如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 根据不同语言规则，具体语法有所不同，此处以NodeJs的express为例</span>
<span class="token comment">//设置跨域访问  </span>
app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;X-Requested-With&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Methods&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;PUT,POST,GET,DELETE,OPTIONS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
</code></pre></div><p>Nginx实现如下：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    
    <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Credentials <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Origin <span class="token variable">$http_origin</span><span class="token punctuation">;</span>
    
        
    <span class="token keyword">location</span> <span class="token operator">/</span>file <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request_method</span> <span class="token operator">=</span> <span class="token string">'OPTIONS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Origin <span class="token variable">$http_origin</span><span class="token punctuation">;</span>
            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Methods <span class="token variable">$http_access_control_request_method</span><span class="token punctuation">;</span>
            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Credentials <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Headers <span class="token variable">$http_access_control_request_headers</span><span class="token punctuation">;</span>
            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span>Max<span class="token operator">-</span>Age <span class="token number">1728000</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">204</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>         
    <span class="token punctuation">}</span>
	
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="网络协议"><a href="#网络协议" aria-hidden="true" class="header-anchor">#</a> 网络协议</h2> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/osl.png" alt></p> <h3 id="tcp"><a href="#tcp" aria-hidden="true" class="header-anchor">#</a> TCP</h3> <p>传输控制协议（TCP，Transmission Control Protocol）是一种面向连接的、可靠的、基于字节流的传输层通信协议，由 IETF 的 RFC 793 定义。</p> <ul><li>基于流的方式</li> <li>面向连接</li> <li>丢包重传</li> <li>保证数据顺序</li></ul> <h3 id="udp"><a href="#udp" aria-hidden="true" class="header-anchor">#</a> UDP</h3> <p>Internet 协议集支持一个无连接的传输协议，该协议称为用户数据报协议（UDP，User Datagram Protocol）。UDP 为应用程序提供了一种无需建立连接就可以发送封装的 IP 数据包的方法。RFC 768 描述了 UDP。</p> <ul><li>UDP 是非连接的协议，也就是不会跟终端建立连接</li> <li>UDP 包信息只有 8 个字节</li> <li>UDP 是面向报文的。既不拆分，也不合并，而是保留这些报文的边界</li> <li>UDP 可能丢包</li> <li>UDP 不保证数据顺序</li></ul> <h3 id="http"><a href="#http" aria-hidden="true" class="header-anchor">#</a> HTTP</h3> <ul><li><p>HTTP/0.9：GET，无状态的特点形成</p></li> <li><p>HTTP/1.0：支持 POST，HEAD，添加了请求头和响应头，支持任何格式的文件发送，添加了状态码、多字符集支持、多部分发送、权限、缓存、内容编码等</p></li> <li><p>HTTP/1.1：默认长连接，同时 6 个 TCP 连接，CDN 域名分片</p></li> <li><p>HTTPS：HTTP + TLS（ <strong>非对称加密</strong> 与 <strong>对称加密</strong> ）</p> <ol><li>客户端发出 https 请求，请求服务端建立 SSL 连接</li> <li>服务端收到 https 请求，申请或自制数字证书，得到公钥和服务端私钥，并将公钥发送给客户端</li> <li>户端验证公钥，不通过验证则发出警告，通过验证则产生一个随机的客户端私钥</li> <li>客户端将公钥与客户端私钥进行对称加密后传给服务端</li> <li>服务端收到加密内容后，通过服务端私钥进行非对称解密，得到客户端私钥</li> <li>服务端将客户端私钥和内容进行对称加密，并将加密内容发送给客户端</li> <li>客户端收到加密内容后，通过客户端私钥进行对称解密，得到内容</li></ol></li> <li><p>HTTP/2.0：多路复用（一次 TCP 连接可以处理多个请求），服务器主动推送，stream 传输。</p></li> <li><p>HTTP/3：基于 UDP 实现了 QUIC 协议</p> <ul><li>建立好 HTTP2 连接</li> <li>发送 HTTP2 扩展帧</li> <li>使用 QUIC 建立连接</li> <li>如果成功就断开 HTTP2 连接</li> <li>升级为 HTTP3 连接</li></ul></li></ul> <p><strong>注：RTT = Round-trip time</strong></p> <h2 id="页面渲染流程"><a href="#页面渲染流程" aria-hidden="true" class="header-anchor">#</a> 页面渲染流程</h2> <blockquote><p>构建 DOM 树、样式计算、布局阶段、分层、绘制、分块、光栅化和合成</p></blockquote> <ol><li><p>创建 DOM tree</p> <ul><li>遍历 DOM 树中的所有可见节点，并把这些节点加到布局树中。</li> <li>不可见的节点会被布局树忽略掉。</li></ul></li> <li><p>样式计算</p> <ul><li>创建 CSSOM tree</li> <li>转换样式表中的属性值</li> <li>计算出 DOM 节点样式</li></ul></li> <li><p>生成 layout tree</p></li> <li><p>分层</p> <ul><li>生成图层树（LayerTree）</li> <li>拥有层叠上下文属性的元素会被提升为单独的一层</li> <li>需要剪裁（clip）的地方也会被创建为图层</li> <li>图层绘制</li></ul></li> <li><p>将图层转换为位图</p></li> <li><p>合成位图并显示在页面中</p></li></ol> <h2 id="页面更新机制"><a href="#页面更新机制" aria-hidden="true" class="header-anchor">#</a> 页面更新机制</h2> <ul><li>更新了元素的几何属性（重排）</li> <li>更新元素的绘制属性（重绘）</li> <li>直接合成
<ul><li>CSS3 的属性可以直接跳到这一步</li></ul></li></ul> <h2 id="js-执行机制"><a href="#js-执行机制" aria-hidden="true" class="header-anchor">#</a> JS 执行机制</h2> <h3 id="代码提升（为了编译）"><a href="#代码提升（为了编译）" aria-hidden="true" class="header-anchor">#</a> 代码提升（为了编译）</h3> <ul><li>变量提升</li> <li>函数提升（优先级最高）</li></ul> <h3 id="编译代码"><a href="#编译代码" aria-hidden="true" class="header-anchor">#</a> 编译代码</h3> <p><strong>V8 编译 JS 代码的过程</strong></p> <ol><li><p>生成抽象语法树（AST）和执行上下文</p></li> <li><p>第一阶段是分词（tokenize），又称为词法分析</p></li> <li><p>第二阶段是解析（parse），又称为语法分析</p></li> <li><p>生成字节码</p> <p>字节码就是介于 AST 和机器码之间的一种代码。但是与特定类型的机器码无关，字节码需要通过解释器将其转换为机器码后才能执行。</p></li> <li><p>执行代码</p></li></ol> <p><strong>高级语言编译器步骤：</strong></p> <ol><li>输入源程序字符流</li> <li>词法分析</li> <li>语法分析</li> <li>语义分析</li> <li>中间代码生成</li> <li>机器无关代码优化</li> <li>代码生成</li> <li>机器相关代码优化</li> <li>目标代码生成</li></ol> <h3 id="执行代码"><a href="#执行代码" aria-hidden="true" class="header-anchor">#</a> 执行代码</h3> <ul><li>执行全局代码时，创建全局上下文</li> <li>调用函数时，创建函数上下文</li> <li>使用 eval 函数时，创建 eval 上下文</li> <li>执行局部代码时，创建局部上下文</li></ul> <h2 id="类型"><a href="#类型" aria-hidden="true" class="header-anchor">#</a> 类型</h2> <h3 id="基本类型"><a href="#基本类型" aria-hidden="true" class="header-anchor">#</a> 基本类型</h3> <ul><li>Undefined</li> <li>Null</li> <li>Boolean</li> <li>String</li> <li>Symbol</li> <li>Number</li> <li>Object</li> <li>BigInt</li></ul> <h3 id="复杂类型"><a href="#复杂类型" aria-hidden="true" class="header-anchor">#</a> 复杂类型</h3> <ul><li>Object</li></ul> <h2 id="隐式转换规则"><a href="#隐式转换规则" aria-hidden="true" class="header-anchor">#</a> 隐式转换规则</h2> <h3 id="基本情况"><a href="#基本情况" aria-hidden="true" class="header-anchor">#</a> 基本情况</h3> <ul><li>转换为布尔值</li> <li>转换为数字</li> <li>转换为字符串</li></ul> <h3 id="转换为原始类型"><a href="#转换为原始类型" aria-hidden="true" class="header-anchor">#</a> 转换为原始类型</h3> <p>对象在转换类型的时候，会执行原生方法 <strong>ToPrimitive</strong> 。</p> <p>其算法如下：</p> <ol><li>如果已经是 <strong>原始类型</strong>，则返回当前值；</li> <li>如果需要转 <strong>字符串</strong> 则先调用<code>toSting</code>方法，如果此时是 <strong>原始类型</strong> 则直接返回，否则再调用<code>valueOf</code>方法并返回结果；</li> <li>如果不是 <strong>字符串</strong>，则先调用<code>valueOf</code>方法，如果此时是 <strong>原始类型</strong> 则直接返回，否则再调用<code>toString</code>方法并返回结果；</li> <li>如果都没有 <strong>原始类型</strong> 返回，则抛出 <strong>TypeError</strong> 类型错误。</li></ol> <p>当然，我们可以通过重写<code>Symbol.toPrimitive</code>来制定转换规则，此方法在转原始类型时调用优先级最高。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
data <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
</code></pre></div><h3 id="转换为布尔值"><a href="#转换为布尔值" aria-hidden="true" class="header-anchor">#</a> 转换为布尔值</h3> <p>对象转换为布尔值的规则如下表：</p> <table><thead><tr><th>参数类型</th> <th>结果</th></tr></thead> <tbody><tr><td>Undefined</td> <td>返回 <code>false</code>。</td></tr> <tr><td>Null</td> <td>返回 <code>false</code>。</td></tr> <tr><td>Boolean</td> <td>返回 当前参数。</td></tr> <tr><td>Number</td> <td>如果参数为<code>+0</code>、<code>-0</code>或<code>NaN</code>，则返回 <code>false</code>；其他情况则返回 <code>true</code>。</td></tr> <tr><td>String</td> <td>如果参数为空字符串，则返回 <code>false</code>；否则返回 <code>true</code>。</td></tr> <tr><td>Symbol</td> <td>返回 <code>true</code>。</td></tr> <tr><td>Object</td> <td>返回 <code>true</code>。</td></tr></tbody></table> <h3 id="转换为数字"><a href="#转换为数字" aria-hidden="true" class="header-anchor">#</a> 转换为数字</h3> <p>对象转换为数字的规则如下表：</p> <table><thead><tr><th>参数类型</th> <th>结果</th></tr></thead> <tbody><tr><td>Undefined</td> <td>返回 <code>NaN</code>。</td></tr> <tr><td>Null</td> <td>Return +0.</td></tr> <tr><td>Boolean</td> <td>如果参数为 <code>true</code>，则返回 <code>1</code>；<code>false</code>则返回 <code>+0</code>。</td></tr> <tr><td>Number</td> <td>返回当前参数。</td></tr> <tr><td>String</td> <td>先调用 <strong>ToPrimitive</strong> ，再调用 <strong>ToNumber</strong> ，然后返回结果。</td></tr> <tr><td>Symbol</td> <td>抛出 <code>TypeError</code>错误。</td></tr> <tr><td>Object</td> <td>先调用 <strong>ToPrimitive</strong> ，再调用 <strong>ToNumber</strong> ，然后返回结果。</td></tr></tbody></table> <h3 id="转换为字符串"><a href="#转换为字符串" aria-hidden="true" class="header-anchor">#</a> 转换为字符串</h3> <p>对象转换为字符串的规则如下表：</p> <table><thead><tr><th>参数类型</th> <th>结果</th></tr></thead> <tbody><tr><td>Undefined</td> <td>返回 <code>&quot;undefined&quot;</code>。</td></tr> <tr><td>Null</td> <td>返回 <code>&quot;null&quot;</code>。</td></tr> <tr><td>Boolean</td> <td>如果参数为 <code>true</code> ,则返回 <code>&quot;true&quot;</code>；否则返回 <code>&quot;false&quot;</code>。</td></tr> <tr><td>Number</td> <td>调用 <strong>NumberToString</strong> ，然后返回结果。</td></tr> <tr><td>String</td> <td>返回 当前参数。</td></tr> <tr><td>Symbol</td> <td>抛出 <code>TypeError</code>错误。</td></tr> <tr><td>Object</td> <td>先调用 <strong>ToPrimitive</strong> ，再调用 <strong>ToString</strong> ，然后返回结果。</td></tr></tbody></table> <h2 id="this"><a href="#this" aria-hidden="true" class="header-anchor">#</a> this</h2> <p>this 是和执行上下文绑定的。</p> <p><strong>执行上下文：</strong></p> <ul><li>全局执行上下文：全局执行上下文中的 this 也是指向 window 对象。</li> <li>函数执行上下文：使用对象来调用其内部的一个方法，该方法的 this 是指向对象本身的。</li> <li>eval 执行上下文：执行 eval 环境内部的上两个情况。</li></ul> <p>根据优先级最高的来决定 <code>this</code> 最终指向哪里。</p> <p>首先，<code>new</code> 的方式优先级最高，接下来是 <code>bind</code> 这些函数，然后是 <code>obj.foo()</code> 这种调用方式，最后是 <code>foo</code> 这种调用方式，同时，箭头函数的 <code>this</code> 一旦被绑定，就不会再被任何方式所改变。</p> <p>三点注意：</p> <ol><li>当函数作为对象的方法调用时，函数中的 this 就是该对象；</li> <li>当函数被正常调用时，在严格模式下，this 值是 undefined，非严格模式下 this 指向的是全局对象 window；</li> <li>嵌套函数中的 this 不会继承外层函数的 this 值。</li> <li>我们还提了一下箭头函数，因为箭头函数没有自己的执行上下文，所以箭头函数的 this 就是它外层函数的 this。</li></ol> <h2 id="闭包"><a href="#闭包" aria-hidden="true" class="header-anchor">#</a> 闭包</h2> <p><strong>没有被引用的闭包会被自动回收，但还存在全局变量中，则依然会内存泄漏。</strong></p> <p>在 JavaScript 中，根据词法作用域的规则，内部函数总是可以访问其外部函数中声明的变量，当通过调用一个外部函数返回一个内部函数后，即使该外部函数已经执行结束了，但是内部函数引用外部函数的变量依然保存在内存中，我们就把这些变量的集合称为闭包。比如外部函数是 foo，那么这些变量的集合就称为 foo 函数的闭包。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> getNum<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">inner</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    n<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> inner<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
getNum <span class="token operator">=</span> <span class="token function">getCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
<span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
<span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
</code></pre></div><h2 id="作用域"><a href="#作用域" aria-hidden="true" class="header-anchor">#</a> 作用域</h2> <h3 id="全局作用域"><a href="#全局作用域" aria-hidden="true" class="header-anchor">#</a> 全局作用域</h3> <p>对象在代码中的任何地方都能访问，其生命周期伴随着页面的生命周期。</p> <h3 id="函数作用域"><a href="#函数作用域" aria-hidden="true" class="header-anchor">#</a> 函数作用域</h3> <p>函数内部定义的变量或者函数，并且定义的变量或者函数只能在函数内部被访问。函数执行结束之后，函数内部定义的变量会被销毁。</p> <h3 id="局部作用域"><a href="#局部作用域" aria-hidden="true" class="header-anchor">#</a> 局部作用域</h3> <p>使用一对大括号包裹的一段代码，比如函数、判断语句、循环语句，甚至单独的一个{}都可以被看作是一个块级作用域。</p> <h2 id="作用域链"><a href="#作用域链" aria-hidden="true" class="header-anchor">#</a> 作用域链</h2> <h3 id="词法作用域"><a href="#词法作用域" aria-hidden="true" class="header-anchor">#</a> 词法作用域</h3> <p>词法作用域就是指作用域是由代码中函数声明的位置来决定的，所以词法作用域是静态的作用域，通过它就能够预测代码在执行过程中如何查找标识符。</p> <p>词法作用域是代码阶段就决定好的，和函数是怎么调用的没有关系。</p> <h2 id="原型-原型链"><a href="#原型-原型链" aria-hidden="true" class="header-anchor">#</a> 原型&amp;原型链</h2> <p>其实每个 JS 对象都有 <code>__proto__</code> 属性，这个属性指向了原型。</p> <p>原型也是一个对象，并且这个对象中包含了很多函数，对于 <code>obj</code> 来说，可以通过 <code>__proto__</code> 找到一个原型对象，在该对象中定义了很多函数让我们来使用。</p> <p>原型链：</p> <ul><li><code>Object</code> 是所有对象的爸爸，所有对象都可以通过 <code>__proto__</code> 找到它</li> <li><code>Function</code> 是所有函数的爸爸，所有函数都可以通过 <code>__proto__</code> 找到它</li> <li>函数的 <code>prototype</code> 是一个对象</li> <li>对象的 <code>__proto__</code> 属性指向原型， <code>__proto__</code> 将对象和原型连接起来组成了原型链</li></ul> <h2 id="v8-工作原理"><a href="#v8-工作原理" aria-hidden="true" class="header-anchor">#</a> V8 工作原理</h2> <h3 id="数据存储"><a href="#数据存储" aria-hidden="true" class="header-anchor">#</a> 数据存储</h3> <ul><li>栈空间：先进后出的数据结构，调用栈，存储执行上下文，以及存储原始类型的数据。</li> <li>堆空间：用数组实现的二叉树，存储引用类型。堆空间很大，能存放很多大的数据。存放在堆内存中的对象，变量实际保存的是一个指针，这个指针指向另一个位置。</li></ul> <p>原始类型的赋值会完整复制变量值，而引用类型的赋值是复制引用地址。</p> <h3 id="垃圾回收"><a href="#垃圾回收" aria-hidden="true" class="header-anchor">#</a> 垃圾回收</h3> <ul><li><p>回收调用栈内的数据：执行上下文结束且没有被引用时，则会通过向下移动 <strong>记录当前执行状态的指针（称为 ESP）</strong> 来销毁该函数保存在栈中的执行上下文。</p></li> <li><p>回收堆里的数据：</p> <blockquote><p>V8 中会把堆分为新生代和老生代两个区域，</p> <p>新生代中存放的是生存时间短的对象，</p> <p>老生代中存放的生存时间久的对象。</p> <p>垃圾回收重要术语：</p> <ul><li>代际假说
<ul><li>大部分对象在内存中存在的时间很短</li> <li>不死的对象，会活得更久</li></ul></li> <li>分代收集</li></ul></blockquote></li></ul> <p><strong>副垃圾回收器：</strong></p> <p>主要负责新生代的垃圾回收。</p> <p>这个区域不大，但是垃圾回收比较频繁。</p> <p>新生代的垃圾回收算法是 Scavenge 算法。</p> <p>主要把新生代空间对半划分为两个区域：对象区域，空闲区域。</p> <p>当对象区域快被写满时，则会进行一次垃圾清理。</p> <p>流程如下：</p> <ol><li>对对象区域中的垃圾做标记</li> <li>把存活的对象复制到空闲区域中</li> <li>把这些对象有序地排列起来</li> <li>清理完之后，对象区域会与空闲区域互换</li></ol> <p><strong>主垃圾回收器：</strong></p> <p>主垃圾回收器主要负责老生区中的垃圾回收。</p> <p>除了新生区中晋升的对象，一些大的对象会直接被分配到老生区。</p> <p>因此老生区中的对象有两个特点，一个是对象占用空间大，另一个是对象存活时间长。</p> <p>流程如下：</p> <ol><li>从一组根元素开始，递归遍历这组根元素，在这个遍历过程中，区分活动对象以及垃圾数据</li> <li>标记过程和清除过程使用标记 - 清除算法</li> <li>碎片过多会导致大对象无法分配到足够的连续内存时，会使用标记 - 整理算法</li></ol> <p>一旦执行垃圾回收算法，会导致 <strong>全停顿（Stop-The-World）</strong> 。</p> <p>但是 V8 有 <strong>增量标记算法</strong> 。</p> <p>V8 将标记过程分为一个个的子标记过程，同时让垃圾回收标记和 JavaScript 应用逻辑交替进行，直到标记阶段完成。</p> <h2 id="事件循环"><a href="#事件循环" aria-hidden="true" class="header-anchor">#</a> 事件循环</h2> <h3 id="微任务（microtask）"><a href="#微任务（microtask）" aria-hidden="true" class="header-anchor">#</a> 微任务（microtask）</h3> <ul><li>process.nextTick</li> <li>promise</li> <li>Object.observe （已废弃）</li> <li>MutationObserver</li></ul> <h3 id="宏任务（macrotask）"><a href="#宏任务（macrotask）" aria-hidden="true" class="header-anchor">#</a> 宏任务（macrotask）</h3> <ul><li>script</li> <li>setTimeout</li> <li>setInterval</li> <li>setImmediate</li> <li>I/O</li> <li>UI rendering</li></ul> <h3 id="执行顺序"><a href="#执行顺序" aria-hidden="true" class="header-anchor">#</a> 执行顺序</h3> <ol><li>执行同步代码，这属于宏任务</li> <li>执行栈为空，查询是否有微任务需要执行</li> <li>必要的话渲染 UI</li> <li>然后开始下一轮 Event loop，执行宏任务中的异步代码</li></ol> <h2 id="浏览器安全"><a href="#浏览器安全" aria-hidden="true" class="header-anchor">#</a> 浏览器安全</h2> <h3 id="攻击方式"><a href="#攻击方式" aria-hidden="true" class="header-anchor">#</a> 攻击方式</h3> <ul><li><p>xss：将代码注入到网页</p> <ul><li><strong>持久型</strong> ：写入数据库</li> <li><strong>非持久型</strong> ：修改用户代码</li></ul></li> <li><p>csrf：跨站请求伪造。攻击者会虚构一个后端请求地址，诱导用户通过某些途径发送请求。</p></li> <li><p>中间人攻击：中间人攻击是攻击方同时与服务端和客户端建立起了连接，并让对方认为连接是安全的，但是实际上整个通信过程都被攻击者控制了。攻击者不仅能获得双方的通信信息，还能修改通信信息。</p> <ul><li>DNS 欺骗：入侵 DNS 来将用户访问目标改为入侵者指定机器</li> <li>会话劫持：在一次正常的通信过程中，攻击者作为第三方参与到其中，或者是在数据里加入其他信息，甚至将双方的通信模式暗中改变，即从直接联系变成有攻击者参与的联系。</li></ul></li></ul> <h3 id="防御措施"><a href="#防御措施" aria-hidden="true" class="header-anchor">#</a> 防御措施</h3> <ol><li>预防 XSS</li></ol> <ul><li><p>使用转义字符过滤 html 代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">escapeHTML</span> <span class="token operator">=</span> value <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value <span class="token operator">||</span> <span class="token operator">!</span>value<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> value
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&amp;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;amp;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;lt;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&gt;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;gt;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&quot;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/'/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>过滤 SQL 代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">replaceSql</span> <span class="token operator">=</span> value <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value <span class="token operator">||</span> <span class="token operator">!</span>value<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/select|update|delete|exec|count|'|&quot;|=|;|&gt;|&lt;|%/gi</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <ol start="2"><li><p>预防 CSRF</p> <ul><li>验证 HTTP Referer 字段</li> <li>在请求地址中添加 token 并验证</li> <li>在 HTTP 头中自定义属性并验证</li> <li>Get 请求不对数据进行修改</li> <li>接口防跨域处理</li> <li>不让第三方网站访问用户 cookie</li></ul></li> <li><p>预防中间人攻击</p></li></ol> <ul><li>对于 DNS 欺骗：检查本机的 HOSTS 文件</li> <li>对于会话劫持：使用交换式网络代替共享式网络，还必须使用静态 ARP、捆绑 MAC+IP 等方法来限制欺骗，以及采用认证方式的连接等。</li></ul> <ol start="4"><li>内容安全策略（CSP）</li></ol> <p>内容安全策略 (CSP) 是一个额外的安全层，用于检测并削弱某些特定类型的攻击，包括跨站脚本 (XSS) 和数据注入攻击等。无论是数据盗取、网站内容污染还是散发恶意软件，这些攻击都是主要的手段。</p> <p>措施如下：</p> <ul><li>HTTP Header 中的 <code>Content-Security-Policy</code></li> <li><code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot;&gt;</code></li></ul> <h2 id="浏览器性能"><a href="#浏览器性能" aria-hidden="true" class="header-anchor">#</a> 浏览器性能</h2> <h3 id="dns-预解析"><a href="#dns-预解析" aria-hidden="true" class="header-anchor">#</a> DNS 预解析</h3> <ul><li><code>&lt;link rel=&quot;dns-prefetch&quot; href=&quot;&quot; /&gt;</code></li> <li>Chrome 和 Firefox 3.5+ 能自动进行预解析</li> <li>关闭 DNS 预解析：<code>&lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;off|on&quot;&gt;</code></li></ul> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/chche-whole.png" alt></p> <h3 id="强缓存"><a href="#强缓存" aria-hidden="true" class="header-anchor">#</a> 强缓存</h3> <ol><li><p>Expires</p> <ul><li>缓存过期时间，用来指定资源到期的时间，是服务器端的具体的时间点。</li> <li>Expires 是 HTTP/1 的产物，受限于本地时间，如果修改了本地时间，可能会造成缓存失效。</li></ul></li> <li><p>Cache-Control</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/cache-key.png" alt></p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/cache-flow.png" alt></p></li></ol> <h3 id="协商缓存"><a href="#协商缓存" aria-hidden="true" class="header-anchor">#</a> 协商缓存</h3> <blockquote><p>协商缓存就是强制缓存失效后，浏览器携带缓存标识向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程。</p></blockquote> <ul><li>服务器响应头：Last-Modified，Etag</li> <li>浏览器请求头：If-Modified-Since，If-None-Match</li></ul> <p><strong>Last-Modified</strong> 与 <strong>If-Modified-Since</strong> 配对。<code>Last-Modified</code> 把 Web 应用最后修改时间告诉客户端，客户端下次请求之时会把 <code>If-Modified-Since</code> 的值发生给服务器，服务器由此判断是否需要重新发送资源，如果不需要则返回 304，如果有则返回 200。这对组合的缺点是只能精确到秒，而且是根据本地打开时间来记录的，所以会不准确。</p> <p><strong>Etag</strong> 与 <strong>If-None-Match</strong> 配对。它们没有使用时间作为判断标准，而是使用了一组特征串。<code>Etag</code>把此特征串发生给客户端，客户端在下次请求之时会把此特征串作为<code>If-None-Match</code>的值发送给服务端，服务器由此判断是否需要重新发送资源，如果不需要则返回 304，如果有则返回 200。</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/HTTPcache.png" alt></p> <h2 id="nodejs"><a href="#nodejs" aria-hidden="true" class="header-anchor">#</a> NodeJs</h2> <h3 id="单线程"><a href="#单线程" aria-hidden="true" class="header-anchor">#</a> 单线程</h3> <p>基础概念：</p> <ul><li><p>进程：进程（英语：process），是指计算机中已运行的程序。进程曾经是分时系统的基本运作单位。</p></li> <li><p>线程：线程（英语：thread）是操作系统能够进行运算调度的最小单位。大部分情况下，它被包含在进程之中，是进程中的实际运作单位。</p></li> <li><p>协程：协程（英语：coroutine），又称微线程，是计算机程序的一类组件，推广了协作式多任务的子程序，允许执行被挂起与被恢复。</p></li></ul> <p>Node 中最核心的是 v8 引擎，在 Node 启动后，会创建 v8 的实例，这个实例是多线程的，各个线程如下：</p> <ul><li><p>主线程：编译、执行代码。</p></li> <li><p>编译/优化线程：在主线程执行的时候，可以优化代码。</p></li> <li><p>分析器线程：记录分析代码运行时间，为 Crankshaft 优化代码执行提供依据。</p></li> <li><p>垃圾回收的几个线程。</p></li></ul> <h3 id="非阻塞-i-o"><a href="#非阻塞-i-o" aria-hidden="true" class="header-anchor">#</a> 非阻塞 I/O</h3> <p><strong>阻塞</strong> 是指在 Node.js 程序中，其它 JavaScript 语句的执行，必须等待一个非 JavaScript 操作完成。这是因为当 <strong>阻塞</strong> 发生时，事件循环无法继续运行 JavaScript。</p> <p>在 Node.js 中，JavaScript 由于执行 CPU 密集型操作，而不是等待一个非 JavaScript 操作（例如 I/O）而表现不佳，通常不被称为 <strong>阻塞</strong>。在 Node.js 标准库中使用 libuv 的同步方法是最常用的 <strong>阻塞</strong> 操作。原生模块中也有 <strong>阻塞</strong> 方法。</p> <h3 id="事件循环-2"><a href="#事件循环-2" aria-hidden="true" class="header-anchor">#</a> 事件循环</h3> <div class="language- extra-class"><pre class="language-text"><code>   ┌───────────────────────────┐
┌─&gt;│           timers          │
│  └─────────────┬─────────────┘
│  ┌─────────────┴─────────────┐
│  │     pending callbacks     │
│  └─────────────┬─────────────┘
│  ┌─────────────┴─────────────┐
│  │       idle, prepare       │
│  └─────────────┬─────────────┘      ┌───────────────┐
│  ┌─────────────┴─────────────┐      │   incoming:   │
│  │           poll            │&lt;─────┤  connections, │
│  └─────────────┬─────────────┘      │   data, etc.  │
│  ┌─────────────┴─────────────┐      └───────────────┘
│  │           check           │
│  └─────────────┬─────────────┘
│  ┌─────────────┴─────────────┐
└──┤      close callbacks      │
   └───────────────────────────┘
</code></pre></div><p><strong>注意：每个框被称为事件循环机制的一个阶段。</strong></p> <p><strong>在 Windows 和 Unix/Linux 实现之间存在细微的差异，但这对演示来说并不重要。</strong></p> <p>阶段概述：</p> <ul><li><p><strong>定时器</strong> ：本阶段执行已经被 <code>setTimeout()</code> 和 <code>setInterval()</code> 的调度回调函数。</p></li> <li><p><strong>待定回调</strong> ：执行延迟到下一个循环迭代的 I/O 回调。</p></li> <li><p><strong>idle, prepare</strong> ：仅系统内部使用。</p></li> <li><p><strong>轮询</strong> ：检索新的 I/O 事件;执行与 I/O 相关的回调（几乎所有情况下，除了关闭的回调函数，那些由计时器和 <code>setImmediate()</code> 调度的之外），其余情况 node 将在适当的时候在此阻塞。</p></li> <li><p><strong>检测</strong> ：<code>setImmediate()</code> 回调函数在这里执行。</p></li> <li><p><strong>关闭的回调函数</strong> ：一些关闭的回调函数，如：<code>socket.on('close', ...)</code>。</p></li></ul> <p>在每次运行的事件循环之间，Node.js 检查它是否在等待任何异步 I/O 或计时器，如果没有的话，则完全关闭。</p> <p><strong><code>process.nextTick()</code></strong> ：它是异步 API 的一部分。从技术上讲不是事件循环的一部分。不管事件循环的当前阶段如何，都将在当前操作完成后处理 <code>nextTickQueue</code>。这里的一个<em>操作</em>被视作为一个从底层 C/C++ 处理器开始过渡，并且处理需要执行的 JavaScript 代码。</p> <h3 id="libuv"><a href="#libuv" aria-hidden="true" class="header-anchor">#</a> Libuv</h3> <p>Libuv 是一个跨平台的异步 IO 库，它结合了 UNIX 下的 libev 和 Windows 下的 IOCP 的特性，最早由 Node.js 的作者开发，专门为 Node.js 提供多平台下的异步 IO 支持。Libuv 本身是由 C++ 语言实现的，Node.js 中的非阻塞 IO 以及事件循环的底层机制都是由 libuv 实现的。</p> <p>在 Windows 环境下，libuv 直接使用 Windows 的 IOCP 来实现异步 IO。在 非 Windows 环境下，libuv 使用多线程（线程池 Thread Pool）来模拟异步 IO，这里仅简要提一下 libuv 中有线程池的概念，之后的文章会介绍 libuv 如何实现进程间通信。</p> <h2 id="手写代码"><a href="#手写代码" aria-hidden="true" class="header-anchor">#</a> 手写代码</h2> <h3 id="new-操作符"><a href="#new-操作符" aria-hidden="true" class="header-anchor">#</a> new 操作符</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">New</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>Fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 创建空对象</span>
  <span class="token keyword">var</span> arg <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> Fn<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// 将obj的原型链__proto__指向构造函数的原型prototype</span>
  obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Fn<span class="token punctuation">;</span> <span class="token comment">// 在原型链 __proto__上设置构造函数的构造器constructor，为了实例化Fn</span>
  Fn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 执行Fn，并将构造函数Fn执行obj</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">;</span> <span class="token comment">// 返回结果</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="深拷贝"><a href="#深拷贝" aria-hidden="true" class="header-anchor">#</a> 深拷贝</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getType</span> <span class="token operator">=</span> data <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取数据类型</span>
  <span class="token keyword">const</span> baseType <span class="token operator">=</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString
    <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^\[object\s(.+)\]$/g</span><span class="token punctuation">,</span> <span class="token string">&quot;$1&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> type <span class="token operator">=</span> data <span class="token keyword">instanceof</span> <span class="token class-name">Element</span> <span class="token operator">?</span> <span class="token string">&quot;element&quot;</span> <span class="token punctuation">:</span> baseType<span class="token punctuation">;</span>
  <span class="token keyword">return</span> type<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">isPrimitive</span> <span class="token operator">=</span> data <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断是否是基本数据类型</span>
  <span class="token keyword">const</span> primitiveType <span class="token operator">=</span> <span class="token string">&quot;undefined,null,boolean,string,symbol,number,bigint,map,set,weakmap,weakset&quot;</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>
    <span class="token string">&quot;,&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 其实还有很多类型</span>
  <span class="token keyword">return</span> primitiveType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token function">getType</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">isObject</span> <span class="token operator">=</span> data <span class="token operator">=&gt;</span> <span class="token function">getType</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">isArray</span> <span class="token operator">=</span> data <span class="token operator">=&gt;</span> <span class="token function">getType</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;array&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">deepClone</span> <span class="token operator">=</span> data <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 缓存值，防止循环引用</span>
  <span class="token keyword">const</span> <span class="token function-variable function">baseClone</span> <span class="token operator">=</span> _data <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> res<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPrimitive</span><span class="token punctuation">(</span>_data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObject</span><span class="token punctuation">(</span>_data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>_data <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>_data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>_data<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 判断是否有复杂类型的数据，有就递归</span>
    Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>key <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getType</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 用cache来记录已经被复制过的引用地址。用来解决循环引用的问题</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>res<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> cache<span class="token punctuation">[</span>res<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          cache<span class="token punctuation">[</span>res<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
          res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">baseClone</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">baseClone</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="手写-bind"><a href="#手写-bind" aria-hidden="true" class="header-anchor">#</a> 手写 bind</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> args1 <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">bindFn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> args2 <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> that2 <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">bindFn</span> <span class="token operator">?</span> <span class="token keyword">this</span> <span class="token punctuation">:</span> context<span class="token punctuation">;</span> <span class="token comment">// 如果当前函数的this指向的是构造函数中的this 则判定为new 操作。如果this是构造函数bindFn new出来的实例，那么此处的this一定是该实例本身。</span>
    <span class="token keyword">return</span> that<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>that2<span class="token punctuation">,</span> args1<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>args2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">Fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 连接原型链用Fn</span>
  <span class="token comment">// 原型赋值</span>
  Fn<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// bindFn的prototype指向和this的prototype一样，指向同一个原型对象</span>
  bindFn<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> bindFn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="手写函数柯里化"><a href="#手写函数柯里化" aria-hidden="true" class="header-anchor">#</a> 手写函数柯里化</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">curry</span> <span class="token operator">=</span> fn <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> fn <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;No function provided&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">curriedFn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> curriedFn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="手写-promise"><a href="#手写-promise" aria-hidden="true" class="header-anchor">#</a> 手写 Promise</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 来源于 https://github.com/bailnl/promise/blob/master/src/promise.js</span>
<span class="token keyword">const</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">FULFILLED</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">isFunction</span> <span class="token operator">=</span> fn <span class="token operator">=&gt;</span> <span class="token keyword">typeof</span> fn <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">isObject</span> <span class="token operator">=</span> obj <span class="token operator">=&gt;</span> obj <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">noop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">nextTick</span> <span class="token operator">=</span> fn <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span>promise<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>promise <span class="token operator">===</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">reject</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&quot;You cannot resolve a promise with itself&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Promise<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>_stauts <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> statusHandler <span class="token operator">=&gt;</span> value <span class="token operator">=&gt;</span> <span class="token function">statusHandler</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      x<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">handler</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">handler</span><span class="token punctuation">(</span>reject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>_stauts <span class="token operator">===</span> <span class="token constant">FULFILLED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fulfill</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> x<span class="token punctuation">.</span>_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>_stauts <span class="token operator">===</span> <span class="token constant">REJECTED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> x<span class="token punctuation">.</span>_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isObject</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> isCalled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> then <span class="token operator">=</span> x<span class="token punctuation">.</span>then<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>then<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> statusHandler <span class="token operator">=&gt;</span> value <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isCalled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">statusHandler</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          isCalled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        then<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token function">handler</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">handler</span><span class="token punctuation">(</span>reject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">fulfill</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isCalled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">fulfill</span><span class="token punctuation">(</span>promise<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">reject</span> <span class="token operator">=</span> <span class="token punctuation">(</span>promise<span class="token punctuation">,</span> reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>promise<span class="token punctuation">.</span>_stauts <span class="token operator">!==</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  promise<span class="token punctuation">.</span>_stauts <span class="token operator">=</span> <span class="token constant">REJECTED</span><span class="token punctuation">;</span>
  promise<span class="token punctuation">.</span>_value <span class="token operator">=</span> reason<span class="token punctuation">;</span>
  <span class="token function">invokeCallback</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">fulfill</span> <span class="token operator">=</span> <span class="token punctuation">(</span>promise<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>promise<span class="token punctuation">.</span>_stauts <span class="token operator">!==</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  promise<span class="token punctuation">.</span>_stauts <span class="token operator">=</span> <span class="token constant">FULFILLED</span><span class="token punctuation">;</span>
  promise<span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token function">invokeCallback</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">invokeCallback</span> <span class="token operator">=</span> promise <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>promise<span class="token punctuation">.</span>_stauts <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>promise<span class="token punctuation">.</span>_callbacks<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">onFulfilled</span> <span class="token operator">=</span> value <span class="token operator">=&gt;</span> value<span class="token punctuation">,</span>
        <span class="token function-variable function">onRejected</span> <span class="token operator">=</span> reason <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> reason<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        thenPromise
      <span class="token punctuation">}</span> <span class="token operator">=</span> promise<span class="token punctuation">.</span>_callbacks<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> value<span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        value <span class="token operator">=</span> <span class="token punctuation">(</span>promise<span class="token punctuation">.</span>_stauts <span class="token operator">===</span> <span class="token constant">FULFILLED</span> <span class="token operator">?</span> onFulfilled <span class="token punctuation">:</span> onRejected<span class="token punctuation">)</span><span class="token punctuation">(</span>
          promise<span class="token punctuation">.</span>_value
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>thenPromise<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>thenPromise<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Promise</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>resolver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token string">`Class constructor Promise cannot be invoked without 'new'`</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isFunction</span><span class="token punctuation">(</span>resolver<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Promise resolver </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>resolver<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not a function`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>_stauts <span class="token operator">=</span> <span class="token constant">PENDING</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> undefined<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_callbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token function">resolver</span><span class="token punctuation">(</span>value <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> reason <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">then</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> thenPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span>noop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_callbacks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_callbacks<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        onFulfilled<span class="token punctuation">:</span> <span class="token function">isFunction</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">)</span> <span class="token operator">?</span> onFulfilled <span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span>
        onRejected<span class="token punctuation">:</span> <span class="token function">isFunction</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span> <span class="token operator">?</span> onRejected <span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span>
        thenPromise
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">invokeCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> thenPromise<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">catch</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="手写防抖函数"><a href="#手写防抖函数" aria-hidden="true" class="header-anchor">#</a> 手写防抖函数</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">debounce</span> <span class="token operator">=</span> <span class="token punctuation">(</span>fn <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> wait <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> immediate<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      fn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="手写节流函数"><a href="#手写节流函数" aria-hidden="true" class="header-anchor">#</a> 手写节流函数</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">throttle</span> <span class="token operator">=</span> <span class="token punctuation">(</span>fn <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> wait <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> prev <span class="token operator">&gt;</span> wait<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      prev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="手写-instanceof"><a href="#手写-instanceof" aria-hidden="true" class="header-anchor">#</a> 手写 instanceOf</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">instanceOf</span> <span class="token operator">=</span> <span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> proto <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
  <span class="token keyword">let</span> prototype <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    proto <span class="token operator">=</span> proto<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="其它知识"><a href="#其它知识" aria-hidden="true" class="header-anchor">#</a> 其它知识</h2> <h3 id="typeof-vs-instanceof"><a href="#typeof-vs-instanceof" aria-hidden="true" class="header-anchor">#</a> typeof vs instanceof</h3> <p><code>instanceof</code> 运算符用来检测 <code>constructor.prototype</code>是否存在于参数 <code>object</code> 的原型链上。</p> <p><code>typeof</code> 操作符返回一个字符串，表示未经计算的操作数的类型。</p> <p>在 JavaScript 最初的实现中，JavaScript 中的值是由一个表示类型的标签和实际数据值表示的。对象的类型标签是 0。由于 <code>null</code> 代表的是空指针（大多数平台下值为 0x00），因此，null 的类型标签是 0，<code>typeof null</code> 也因此返回 <code>&quot;object&quot;</code>。</p> <h3 id="递归"><a href="#递归" aria-hidden="true" class="header-anchor">#</a> 递归</h3> <blockquote><p>递归（英语：Recursion），又译为递回，在数学与计算机科学中，是指在函数的定义中使用函数自身的方法。</p> <p>例如：</p> <p>大雄在房里，用时光电视看着未来的情况。电视画面中的那个时候，他正在房里，用时光电视，看着未来的情况。电视画面中的电视画面的那个时候，他正在房里，用时光电视，看着未来的情况……</p> <p>简单来说，就是 <strong>无限套娃</strong></p></blockquote> <p>我们以斐波那契数列（Fibonacci sequence）为例，看看输入结果会为正无穷的值的情况下，各种递归的情况。</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/fibonacci.png" alt></p> <p>首先是普通版</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fib1</span> <span class="token operator">=</span> n <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> n <span class="token operator">!==</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;..&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> n<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">fib1</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fib1</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>从上面的代码分析，我们不难发现，在<code>fib1</code>里，JS 会不停创建执行上下文，压入栈内，而且在得出结果前不会销毁，所以数大了之后容易爆栈。</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/fib1.png" alt></p> <p>所以我们可以对其进行优化，就是利用 <strong>尾调用</strong> 进行优化。</p> <p>尾调用是指函数的最后一步只返回一个纯函数的调用，而没有别的数据占用引用。代码如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fib2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> n <span class="token operator">!==</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;..&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">fib2</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>不过很遗憾，在 Chrome 83.0.4103.61 里还是会爆。</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/fib2.png" alt></p> <p>然后我们还有备忘录递归法，就是另外申请空间去存储每次递归的值，是个自顶向下的算法。</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/fib4.png" alt></p> <p>可惜，还是挂了。</p> <p>不过在一些递归问题上，我们还可以利用动态规划（Dynamic programming，简称 DP）来解决。</p> <p>动态规划是算法里比较难掌握的一个概念之一，但是基本能用递归来解决的问题，都能用动态规划来解决。</p> <p>动态规划背后的基本思想非常简单。大致上，若要解一个给定问题，我们需要解其不同部分（即子问题），再根据子问题的解以得出原问题的解。</p> <p>跟备忘录递归刚好相反，是自底向上的算法。具体代码如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fib3</span> <span class="token operator">=</span> n <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> n <span class="token operator">!==</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;..&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> n<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> a <span class="token operator">+</span> b<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/js/%20interview2/fib3.png" alt></p> <p>效果很好，正确输出了正无穷~</p> <h2 id="参考资料"><a href="#参考资料" aria-hidden="true" class="header-anchor">#</a> 参考资料</h2> <ol><li><a href="http://gk.link/a/10ivq" target="_blank" rel="noopener noreferrer">浏览器工作原理与实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.jianshu.com/p/1e455a9226ce" target="_blank" rel="noopener noreferrer">浏览器的运行机制—2.浏览器都包含哪些进程？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5c9c3989e51d454e3a3902b6#heading-25" target="_blank" rel="noopener noreferrer">「中高级前端面试」JavaScript 手写代码无敌秘籍<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://segmentfault.com/a/1190000015455662" target="_blank" rel="noopener noreferrer">JavaScript 深拷贝<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/bailnl/promise/blob/master/src/promise.js" target="_blank" rel="noopener noreferrer">bailnl/promise<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://item.m.jd.com/product/12109464.html?wxa_abtest=o&ad_od=share&utm_source=androidapp&utm_medium=appshare&utm_campaign=t_335139774&utm_term=CopyURL" target="_blank" rel="noopener noreferrer">网络是怎样连接的？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://gk.link/a/10ivq" target="_blank" rel="noopener noreferrer">浏览器工作原理与实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/" target="_blank" rel="noopener noreferrer">浏览器的工作原理：新式网络浏览器幕后揭秘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP" target="_blank" rel="noopener noreferrer">内容安全策略( CSP )<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/book/5bdc715fe51d454e755f75ef?referrer=576b433bd342d30057aaa1e9" target="_blank" rel="noopener noreferrer">前端面试之道<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/surui/p/11669346.html" target="_blank" rel="noopener noreferrer">HTTP 各版本的区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.csdn.net/qq_35720307/article/details/89680726" target="_blank" rel="noopener noreferrer">CORS解决跨域问题（Nginx跨域配置）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5d468e056fb9a06b17779927" target="_blank" rel="noopener noreferrer">你觉得 Node.js 是单线程这个结论对吗？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://nodejs.org/zh-cn/docs/guides/" target="_blank" rel="noopener noreferrer">Node 指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/ljianshu/Blog/issues/23" target="_blank" rel="noopener noreferrer">深入理解浏览器的缓存机制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <h2 id="后记"><a href="#后记" aria-hidden="true" class="header-anchor">#</a> 后记</h2> <p>如果你喜欢探讨技术，或者对本文有任何的意见或建议，非常欢迎加鱼头微信好友一起探讨，当然，鱼头也非常希望能跟你一起聊生活，聊爱好，谈天说地。
鱼头的微信号是：krisChans95
也可以扫码关注公众号，订阅更多精彩内容。
公众号窗口回复『 <strong>前端资料</strong> 』，即可获取约 200M 前端面试资料，不要错过。</p> <p><img src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/base/qrcode-all1.png" alt></p></div> <div class="page-footer content">
    网站备案号：粤ICP备17113436号-1
  </div> <!----> <div class="right-group"><div class="item"><span class="title">加入前端鱼塘</span> <span class="desc">
        扫描二维码回复
        <span class="inner">加群</span> 学习
      </span> <img width="100%" src="https://fish-pond-1253945200.cos.ap-guangzhou.myqcloud.com/img/base/wx-qrcode.jpg"></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <div></div></div></div>
    <script src="/assets/js/43.c9233ecb.js" defer></script><script src="/assets/js/app.15224212.js" defer></script>
    <!-- Hotjar Tracking Code for yuchengkai.cn -->
    <script>
      var _hmt = _hmt || []
      ;(function() {
        var hm = document.createElement('script')
        hm.src = 'https://hm.baidu.com/hm.js?52ee35894430604d0d3ce3b9c089adf9'
        var s = document.getElementsByTagName('script')[0]
        s.parentNode.insertBefore(hm, s)
      })()
    </script>
  </body>
</html>
